{"version":3,"sources":["./src/app/pages/chat-room/chat-room.page.html","./src/app/pages/chat-room/chat-room.module.ts","./src/app/pages/chat-room/chat-room.page.scss","./src/app/pages/chat-room/chat-room.page.ts"],"names":[],"mappings":"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","file":"pages-chat-room-chat-room-module-es2015.js","sourcesContent":["module.exports = \"<ion-header>\\r\\n  <ion-toolbar _bg-theme-color>\\r\\n    <ion-icon slot=\\\"start\\\" name=\\\"arrow-round-back\\\" padding style=\\\"padding-right: 0px\\\" (click)=\\\"goBack()\\\">\\r\\n    </ion-icon>\\r\\n    <ion-avatar slot=\\\"start\\\" padding (click)=\\\"goBack()\\\">\\r\\n      <img src=\\\"../../../assets/imgs/avatar/avatar9.jpg\\\">\\r\\n    </ion-avatar>\\r\\n    {{recieverName | titlecase}}\\r\\n    <!-- <ion-icon name=\\\"videocam\\\" slot=\\\"end\\\" padding></ion-icon> -->\\r\\n    <!-- <ion-icon name=\\\"call\\\" slot=\\\"end\\\" padding></ion-icon> -->\\r\\n    <ion-icon name=\\\"log-out\\\" (click)=\\\"logout()\\\" slot=\\\"end\\\" padding></ion-icon>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n\\r\\n<ion-content bg-sky [scrollEvents]=\\\"true\\\" #scrollMe>\\r\\n  <div style=\\\"padding-bottom: 70px;\\\">\\r\\n    <div *ngFor=\\\"let message of messages;let i = index\\\">\\r\\n      <ng-container *ngIf=\\\"message.senderID === senderID\\\">\\r\\n        <div flex flow-right>\\r\\n          <ion-card bg-light>\\r\\n            <ion-card-content style=\\\"padding-bottom: 0px;\\\">\\r\\n              {{ message.msg }}\\r\\n            </ion-card-content>\\r\\n            <p text-right no-margin light-time>{{ api.formatAMPM(message?.timestamp?.toDate()) }}</p>\\r\\n          </ion-card>\\r\\n        </div>\\r\\n      </ng-container>\\r\\n      <ng-container *ngIf=\\\"message.senderID !== senderID\\\">\\r\\n\\r\\n        <div flex>\\r\\n          <ion-card bg-white>\\r\\n            <ion-card-content style=\\\"padding-bottom: 0px;\\\">\\r\\n              {{ message.msg }}\\r\\n            </ion-card-content>\\r\\n            <p text-right no-margin light-time>{{ api.formatAMPM(message?.timestamp?.toDate()) }}</p>\\r\\n          </ion-card>\\r\\n        </div>\\r\\n      </ng-container>\\r\\n    </div>\\r\\n  </div>\\r\\n\\r\\n  <div *ngIf=\\\"loader\\\" flex v-center h-center style=\\\"height: 100%;\\\">\\r\\n    <ion-spinner name=\\\"crescent\\\" color=\\\"success\\\" style=\\\"width: 100px; height: 100px;\\\"></ion-spinner>\\r\\n  </div>\\r\\n</ion-content>\\r\\n\\r\\n\\r\\n<ion-footer>\\r\\n  <ion-toolbar>\\r\\n    <div slot=\\\"start\\\" padding>\\r\\n      ðŸ˜€\\r\\n    </div>\\r\\n    <ion-input [(ngModel)]=\\\"message\\\" placeholder=\\\"Type here...\\\"></ion-input>\\r\\n    <ion-icon (click)=\\\"sendChat()\\\" name=\\\"send\\\" slot=\\\"end\\\" padding></ion-icon>\\r\\n  </ion-toolbar>\\r\\n</ion-footer>\"","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { ChatRoomPage } from './chat-room.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: ChatRoomPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    RouterModule.forChild(routes)\r\n  ],\r\n  declarations: [ChatRoomPage]\r\n})\r\nexport class ChatRoomPageModule {}\r\n","module.exports = \"ion-card {\\n  width: 80%;\\n}\\n\\n[flow-right] {\\n  -webkit-box-orient: horizontal;\\n  -webkit-box-direction: reverse;\\n          flex-flow: row-reverse;\\n}\\n\\n[bg-sky] {\\n  --background: #f8fafa;\\n}\\n\\n[bg-white] {\\n  --background: #fff;\\n  --color: #000;\\n}\\n\\n[bg-light] {\\n  --background: #cfebb1;\\n  --color: #000;\\n}\\n\\n[light-time] {\\n  color: #6a6a6a;\\n  font-size: 0.7rem;\\n  padding: 5px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvY2hhdC1yb29tL0Q6XFxzYWlcXHByb2plY3RzXFxzYW1wbGVzXFxpb25pYy1tZXNzZW5nZXItZmlyZWJhc2Uvc3JjXFxhcHBcXHBhZ2VzXFxjaGF0LXJvb21cXGNoYXQtcm9vbS5wYWdlLnNjc3MiLCJzcmMvYXBwL3BhZ2VzL2NoYXQtcm9vbS9jaGF0LXJvb20ucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksVUFBQTtBQ0NKOztBRENBO0VBQ0ksOEJBQUE7RUFBQSw4QkFBQTtVQUFBLHNCQUFBO0FDRUo7O0FERUE7RUFDSSxxQkFBQTtBQ0NKOztBRENBO0VBQ0ksa0JBQUE7RUFDQSxhQUFBO0FDRUo7O0FEQUE7RUFDSSxxQkFBQTtFQUNBLGFBQUE7QUNHSjs7QUREQTtFQUNJLGNBQUE7RUFDQSxpQkFBQTtFQUNBLFlBQUE7QUNJSiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL2NoYXQtcm9vbS9jaGF0LXJvb20ucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaW9uLWNhcmQge1xyXG4gICAgd2lkdGg6IDgwJTtcclxufVxyXG5bZmxvdy1yaWdodF0ge1xyXG4gICAgZmxleC1mbG93OiByb3ctcmV2ZXJzZTtcclxufVxyXG5cclxuXHJcbltiZy1za3ldIHtcclxuICAgIC0tYmFja2dyb3VuZDogI2Y4ZmFmYTtcclxufVxyXG5bYmctd2hpdGVde1xyXG4gICAgLS1iYWNrZ3JvdW5kOiAjZmZmO1xyXG4gICAgLS1jb2xvcjogIzAwMDtcclxufVxyXG5bYmctbGlnaHRdIHtcclxuICAgIC0tYmFja2dyb3VuZDogI2NmZWJiMTtcclxuICAgIC0tY29sb3I6ICMwMDA7XHJcbn1cclxuW2xpZ2h0LXRpbWVdIHtcclxuICAgIGNvbG9yOiAjNmE2YTZhO1xyXG4gICAgZm9udC1zaXplOiAwLjdyZW07XHJcbiAgICBwYWRkaW5nOiA1cHg7XHJcbn0iLCJpb24tY2FyZCB7XG4gIHdpZHRoOiA4MCU7XG59XG5cbltmbG93LXJpZ2h0XSB7XG4gIGZsZXgtZmxvdzogcm93LXJldmVyc2U7XG59XG5cbltiZy1za3ldIHtcbiAgLS1iYWNrZ3JvdW5kOiAjZjhmYWZhO1xufVxuXG5bYmctd2hpdGVdIHtcbiAgLS1iYWNrZ3JvdW5kOiAjZmZmO1xuICAtLWNvbG9yOiAjMDAwO1xufVxuXG5bYmctbGlnaHRdIHtcbiAgLS1iYWNrZ3JvdW5kOiAjY2ZlYmIxO1xuICAtLWNvbG9yOiAjMDAwO1xufVxuXG5bbGlnaHQtdGltZV0ge1xuICBjb2xvcjogIzZhNmE2YTtcbiAgZm9udC1zaXplOiAwLjdyZW07XG4gIHBhZGRpbmc6IDVweDtcbn0iXX0= */\"","import { LOCAL_STORAGE_ENUMS } from './../../shared/constants/localstorage.enums';\r\nimport { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { ApiService } from 'src/app/api/api.service';\r\nimport { ThrowStmt } from '@angular/compiler';\r\n\r\n@Component({\r\n  selector: 'app-chat-room',\r\n  templateUrl: './chat-room.page.html',\r\n  styleUrls: ['./chat-room.page.scss'],\r\n})\r\nexport class ChatRoomPage implements OnInit {\r\n  message = '';\r\n  senderUnsubscribe: any;\r\n  reciverUnsubscribe: any;\r\n  messages: any = [];\r\n  loader = true;\r\n  recieverID = '';\r\n  senderID = '';\r\n  recieverName = '';\r\n  @ViewChild('scrollMe', { static: true }) private myScrollContainer;\r\n\r\n  constructor(\r\n    private api: ApiService,\r\n    private activatedRoute: ActivatedRoute,\r\n    private router: Router\r\n  ) {\r\n    this.recieverID = this.activatedRoute.snapshot.queryParams.recieverID;\r\n    this.recieverName = this.activatedRoute.snapshot.queryParams.name;\r\n    this.senderID = localStorage.getItem(LOCAL_STORAGE_ENUMS.loggedInID);\r\n    if (this.recieverID && this.senderID) {\r\n      this.getChat();\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  ionViewDidEnter() {\r\n    this.scrollToBottom();\r\n  }\r\n\r\n  scrollToBottom(): void {\r\n    try {\r\n      this.myScrollContainer.scrollToBottom(1000);\r\n    } catch (err) { }\r\n  }\r\n\r\n  goBack() {\r\n    this.router.navigate(['/home'], { skipLocationChange: false });\r\n  }\r\n\r\n  logout() {\r\n    console.log('lgout');\r\n    this.api.signOut();\r\n  }\r\n\r\n  sendChat() {\r\n    if (this.message !== '') {\r\n      this.api.sendMsg(this.senderID, this.recieverID, this.message);\r\n    }\r\n    this.message = '';\r\n  }\r\n\r\n  getChat() {\r\n    this.senderUnsubscribe = this.api.db.collection(this.senderID)\r\n      .where('recieverID', '==', this.recieverID)\r\n      .onSnapshot((senderSnap) => {\r\n        this.messages = [];\r\n        this.loader = false;\r\n        senderSnap.forEach((doc) => {\r\n          const data = doc.data();\r\n          this.messages.push(data);\r\n        });\r\n        this.reciverUnsubscribe = this.api.db.collection(this.recieverID)\r\n          .where('recieverID', '==', this.senderID)\r\n          .onSnapshot((reciverSnap) => {\r\n            reciverSnap.forEach((doc) => {\r\n              const data = doc.data();\r\n              this.messages.push(data);\r\n            });\r\n            this.messages.sort(this.sortDate);\r\n            this.scrollToBottom();\r\n          });\r\n      });\r\n  }\r\n\r\n  sortDate(a, b) {\r\n    if (a.timestamp && b.timestamp) {\r\n      const dateA = new Date(a.timestamp.toDate());\r\n      const dateB = new Date(b.timestamp.toDate());\r\n      return dateA > dateB ? 1 : -1;\r\n    } else {\r\n      return -1;\r\n    }\r\n  };\r\n\r\n\r\n  ionViewWillLeave() {\r\n    this.senderUnsubscribe();\r\n    this.reciverUnsubscribe();\r\n  }\r\n}\r\n"],"sourceRoot":""}